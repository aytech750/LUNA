<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Luna - Sign Up</title>
  <link rel="stylesheet" href="signup.css"/>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"/>
</head>
<body class="signup-body">
  <div class="form-container">
    <img src="https://i.imgur.com/8KlT8jJ.png" alt="Luna Logo" class="logo" />
    <h1>Create Your Luna Account</h1>
    <form id="signupForm">
      <input type="text" id="name" placeholder="Full Name" required />
      <input type="email" id="email" placeholder="Email" required />
      <input type="password" id="password" placeholder="Password" required />
       <input type="text" id="wakewordInput" placeholder="Enter your wake word (e.g. Luna)" hidden/>

      <div class="record-wakeword">
        <p class="record-title">Record Your Wake Word</p>
        <button type="button" id="recordBtn">
          <img src="https://cdn-icons-png.flaticon.com/512/727/727245.png" alt="Mic" class="mic-icon">
          <span>Start Recording</span>
        </button>
        <p class="record-status" id="record-status">Not recording</p>

      <button type="submit">Sign Up</button>
    </form>

    <p class="login-link">Already have an account? <a href="login.html">Login</a></p>
  </div>
   <div id="spinnerOverlay" class="spinner-overlay" style="display:none;">
      <img src="https://i.imgur.com/8KlT8jJ.png" alt="Luna Spinner" class="spinner-logo" />
    </div>

   
  </div>
  <section class="about-luna">
  <h2>Why Choose <span class="luna">Luna</span>?</h2>
  <div class="features">
    <div>
      <h3>üåü Our Mission</h3>
      <p>To revolutionize the way people connect with technology using voice-driven AI experiences that are simple, secure, and smart.</p>
    </div>
    <div>
      <h3>üöÄ Our Innovation</h3>
      <p>Luna combines the power of AI, voice recognition, and personalized assistance, offering a smarter way to interact with your world.</p>
    </div>
    <div>
      <h3>ü§ù Why Luna?</h3>
      <p>Unlike other platforms, Luna is designed to be intuitive, friendly, and accessible, serving as your social and smart assistant.</p>
    </div>
    <div>
     <h3>üíº About LunaAI</h3>
<p style="display: flex; align-items: center; gap: 12px; flex-wrap: wrap; font-size: 16px; line-height: 1.6;">
  <img src="https://img.icons8.com/color/48/artificial-intelligence.png" alt="AI Icon" style="width: 24px; height: 24px;" />
  <span style="flex: 1;">
    <strong>LunaAI</strong> is an innovative voice assistant developed by <strong>AyTech</strong>‚Äîa rising tech firm known for simplifying complex problems through smart solutions. <br />
    Other products by AyTech include <em>Freenium Data</em>, <em>Osun Ride</em>, and more.
  </span>
  <img src="https://img.icons8.com/fluency/48/source-code.png" alt="Tech Code Icon" style="width: 24px; height: 24px;" />
  <img src="https://img.icons8.com/color/48/voice-recognition.png" alt="Voice Recognition Icon" style="width: 24px; height: 24px;" />
</p>


    </div>
  </div>

  <div class="connect">
    <p>Connect with us:</p>
    <a href="https://wa.me/your_number" target="_blank">
      <img src="https://img.icons8.com/color/48/000000/whatsapp--v1.png" alt="WhatsApp" />
    </a>
    <a href="https://instagram.com/your_handle" target="_blank">
      <img src="https://img.icons8.com/fluency/48/instagram-new.png" alt="Instagram" />
    </a>
    <a href="https://tiktok.com/@your_handle" target="_blank">
      <img src="https://img.icons8.com/color/48/tiktok--v1.png" alt="TikTok" />
    </a>
  </div>

  <div class="credits">
    <p>&copy; 2025 Luna AI - Created by AyTech</p>
  </div>
    <div id="spinnerOverlay" class="spinner-overlay">
      <img src="https://i.imgur.com/8KlT8jJ.png" alt="Luna Spinner" class="spinner-logo" />
    </div>
</section>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDN4hgEwEZkL0gzEmlRWlabjAEt6fY3c88",
    authDomain: "luna-app-a3c50.firebaseapp.com",
    projectId: "luna-app-a3c50",
    storageBucket: "luna-app-a3c50.appspot.com",
    messagingSenderId: "683159311462",
    appId: "1:683159311462:web:2bef289d271172267d49a7"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  let mediaRecorder, audioChunks = [], wakeWordBlob, recordedWakeWord = "", audioURL = "";

  document.getElementById("recordBtn").addEventListener("click", async () => {
    const recordBtn = document.getElementById("recordBtn");
    const status = document.getElementById("record-status");

    try {
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      mediaRecorder = new MediaRecorder(stream);
      audioChunks = [];

      mediaRecorder.ondataavailable = e => audioChunks.push(e.data);

      mediaRecorder.onstop = async () => {
        const audioBlob = new Blob(audioChunks, { type: "audio/webm" });
        wakeWordBlob = audioBlob;

        const wakewordInput = document.getElementById("wakewordInput");
        recordedWakeWord = wakewordInput.value || "Luna";

        const formData = new FormData();
        formData.append("file", audioBlob);
        formData.append("upload_preset", "luna_unsigned");

        const response = await fetch("https://api.cloudinary.com/v1_1/dm8xazeob/raw/upload", {
          method: "POST",
          body: formData,
        });

        const data = await response.json();
        if (!response.ok) {
          alert("Cloudinary upload failed: " + data.error.message);
          return;
        }

        audioURL = data.secure_url;
        speechSynthesis.speak(new SpeechSynthesisUtterance(`Wake word recorded as ${recordedWakeWord}`));
        status.textContent = `Wake word saved: "${recordedWakeWord}"`;
      };

      mediaRecorder.start();
      status.textContent = "Recording...";
      recordBtn.disabled = true;

      setTimeout(() => {
        mediaRecorder.stop();
        recordBtn.disabled = false;
        recordBtn.innerHTML = `<img src="https://cdn-icons-png.flaticon.com/512/727/727245.png" class="mic-icon" /> Re-record Wake Word`;
      }, 3000);
    } catch (err) {
      alert("Microphone access denied or not available.");
    }
  });

  document.getElementById("signupForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const name = document.getElementById("name").value.trim();
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value;
    const spinner = document.getElementById("spinnerOverlay");
    const btn = document.querySelector("button[type='submit']");

    if (!wakeWordBlob || !audioURL) {
      Toastify({ text: "Please record your wake word!", duration: 3000, backgroundColor: "#ffa000" }).showToast();
      return;
    }

    btn.disabled = true;
    spinner.style.display = "flex";

    try {
      const userCredential = await auth.createUserWithEmailAndPassword(email, password);
      const uid = userCredential.user.uid;

      await db.collection("users").doc(uid).set({
        name,
        email,
        wakeword: recordedWakeWord,
        audioURL,
        createdAt: new Date(),
      });

      greetUser(name);
      const wakeWordUtterance = new SpeechSynthesisUtterance(`Your wake word is ${recordedWakeWord}`);
      speechSynthesis.speak(wakeWordUtterance);

      Toastify({ text: `Welcome, ${name}!`, duration: 3000, backgroundColor: "#2563eb" }).showToast();

      setTimeout(() => {
        window.location.href = "dashboard.html";
      }, 3500);
    } catch (error) {
      Toastify({ text: error.message, duration: 3000, backgroundColor: "#d32f2f" }).showToast();
      spinner.style.display = "none";
      btn.disabled = false;
    }
  });

  function greetUser(name) {
    const greeting = `Welcome, ${name}. Luna is now activated and ready to help!`;
    const utterance = new SpeechSynthesisUtterance(greeting);
    speechSynthesis.speak(utterance);
  }
</script>

</body>
</html>
